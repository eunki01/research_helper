version: '3.4'
services:
  weaviate:
    image: semitechnologies/weaviate:1.24.4  # 원하는 버전을 선택합니다.
    ports:
      - "8080:8080"  # REST/HTTP 포트
      - "50051:50051" # gRPC 포트
    restart: on-failure:0
    environment:
      # 벡터화 모듈 설정 (예: 'text2vec-huggingface' 사용)
      QUERY_DEFAULTS_LIMIT: 20
      AUTHENTICATION_APIKEY_ENABLED: 'false'
      PERSISTENCE_DATA_PATH: '/var/lib/weaviate'
      # 메모리 제한 설정 (Docker Desktop에서 설정한 메모리에 따라 조정)
      DEFAULT_VECTORIZER_MODULE: 'text2vec-huggingface'
      ENABLE_MODULES: 'text2vec-huggingface'
      CLUSTER_HOSTNAME: 'node1'
      # Hugging Face 모델 설정 (선택 사항: 원하는 모델로 변경 가능)
      # text2vec-huggingface 모듈을 사용하는 경우에 필요
      HF_API_KEY: '' # API 키가 필요할 수 있습니다.
      HF_MODEL: 'sentence-transformers/all-MiniLM-L6-v2'